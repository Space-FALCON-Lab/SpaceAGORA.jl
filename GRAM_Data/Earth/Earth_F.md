The EarthGRAM F Interface
===========================

This documents the FORTRAN interface for EarthGRAM.  Since the GRAM framework is common to all models, only the Earth specific information is documented on this page.  See the [FORTRAN interface](Documentation/Markdown/GRAM_F.md) page for documentation on the common framework.

A simple example of using the Earth atmosphere can be seen [here](@ref Earth/examples/Earth_F.f90).

- - - - - - - 

Path to Earth Data
------------------

The location of the Earth data files are specified during the creation of the Earth atmosphere handle with the function \ref earthgram::createAtmosphere_E.  

~~~~~~~~~~
TYPE(C_PTR) :: earth
earth = createAtmosphere_E("\path\tomy\earthdata\")
~~~~~~~~~~

Path to Model Data
------------------

Use the function \ref earthgram::setAtmosPath_E to set the folder location of the Earth model data files.  

~~~~~~~~~~
call setAtmosPath_E(earth, "\path\tomy\earthdata\modeldata");
~~~~~~~~~~

MERRA-2 Path and Parameters
---------------------------

Use the function \ref earthgram::setMERRA2Path_E to set the folder location of the MERRA-2 binary data.  Identify the desired MERRA-2 data by specifying an hour code and data extents with \ref earthgram::setMERRA2Parameters_E.

~~~~~~~~~~
call setMERRA2Path_E(earth, "\path\tomy\earthdata\MERRA2data\");
call setMERRA2Parameters_E(earth, 9, -30, 60, -85, 50);
~~~~~~~~~~

NCEP Path and Parameters
------------------------

Use the function \ref earthgram::setNCEPPath_E to set the folder location of the NCEP binary data.  Identify the desired NCEP data by specifying year and hour codes with \ref earthgram::setNCEPParameters_E.  By default, EarthGRAM uses the MERRA-2 model.  To activate the NCEP model, call \ref earthgram::setUseNCEP_E.

~~~~~~~~~~
call setUseNCEP(earth, 1);
call setNCEPPath_E(earth, "\path\tomy\earthdata\NCEPdata\FixedBin");
call setNCEPParameters_E(earth, 9715, 0);
~~~~~~~~~~

Range Reference Atmosphere (RRA) Path and Parameters
----------------------------------------------------

Use the function \ref earthgram::setRRAPath_E to set the folder location of the RRA data.  
The name of the RRA site list file can be set with \ref earthgram::setRRASiteList_E.
The function \ref earthgram::setRRAParameters_E is used to select the year of the RRA 
data set and define a region in which RRA data is used.  Use of the RRA data
is enabled or disabled with \ref earthgram::setUseRRA_E.

~~~~~~~~~~
call setRRAPath_E(earth, "\path\tomy\earthdata\NCEPdata\RRAdata");
call setRRASiteList_E(earth, "rrasites.txt");
call setRRAPParameters_E(earth, 3, 0.5d0, 2.5d0);
call setUseRRA_E(earth, 1);
~~~~~~~~~~

Thermosphere Model
------------------

The thermosphere model is chosen with the \ref GRAM::EarthAtmosphere::setThermosphereModel_E method. Valid models are 1 = MET, 2 = MSIS, and 3 = JB2008.  The default model is 1 = MET.

~~~~~~~~~~
call setThermosphereModel_E(earth, 3);
~~~~~~~~~~

Surface Roughness
-----------------

The surface roughness is set with \ref GRAM::EarthAtmosphere::setSurfaceRoughness_E. Any negative value will signify the use of 1-by-1 degree lat-lon surface data. A zero value will indicate speed-dependent surface roughness over water.  Values between 1.0e-5 and 3 override computed values with the user-specified surface roughness.

~~~~~~~~~~
call setSurfaceRoughness_E(earth, 1.34d0);
~~~~~~~~~~

Solar Parameters
----------------

Set solar flux and the AP geomagnetic index parameters with \ref earthgram::setSolarParameters_E.  

~~~~~~~~~~
call setSolarParameters_E(earth, 73.1d0, 70.1d0, 16.3d0);
~~~~~~~~~~

JB2008 Parameters
-----------------

The function \ref earthgram::setJB2008Parameters_E is used to set parameters for the JB2008 
thermosphere model.

~~~~~~~~~~
call setThermosphereModel_E(earth, 3);
call setJB2008Parameters_E(earth, 120.4d0, 120.9d0, 127.3d0, 125.5d0, 133.0d0, 133.1d0, 17.0d0);
~~~~~~~~~~

Initial Perturbations
---------------------

The function \ref earthgram::setInitialPerturbations_E is used to override the random initial
perturbations generated by EarthGRAM.

~~~~~~~~~~
call setInitialPerturbations_E(earth, 4.7d-9, 601.17d0, 91.66d0, -69.4d0, -3.4d0);
~~~~~~~~~~

Patchiness
----------

Use \ref earthgram::setPatchiness_E to enable patchiness in the perturbation model.  

~~~~~~~~~~
call setPatchiness_E(earth, 1);
~~~~~~~~~~

Earth Specific Metrics
----------------------

EarthGRAM has many metrics in common with all other models.  However, the earth model has many metrics that particular to this model.  These may be retrieved with the method  \ref GRAM::EarthAtmosphere::getEarthState_E.

~~~~~~~~~~
TYPE(EarthState_F) :: eState
call getEarthState_E(earth, &eState);
~~~~~~~~~~

