The EarthGRAM C++ Interface
=============================

This documents the \ref GRAM::EarthAtmosphere interface class for EarthGRAM.  Since the GRAM framework is common to all models, only the Earth specific information is documented on this page.  See the [C++ interface](Documentation/Markdown/GRAM.md) page for documentation on the common framework.

A simple example of using the Earth atmosphere class can be seen [here](@ref Earth/examples/Earth.cpp).

- - - - - - - 

Path to Earth Data
------------------

The location of the Earth data files is specified with the method \ref GRAM::EarthAtmosphere::setDataPath.  This method will automatically set the atmos, NCEP, and RRA paths using the standard folder names "modeldata", "NCEPdata\FixedBin", and "RRAdata", respectively.

~~~~~~~~~~
earth.setDataPath("\path\tomy\earthdata\");
~~~~~~~~~~

Path to Model Data
------------------

The method \ref GRAM::EarthAtmosphere::setAtmosPath can be used to set the folder location of the Earth model data files. 

~~~~~~~~~~
earth.setAtmosPath("\path\tomy\earthdata\modeldata");
~~~~~~~~~~

MERRA-2 Path and Parameters
---------------------------

Use the function \ref GRAM::EarthAtmosphere::setMERRA2Path to set the folder location of the MERRA-2 binary data.  Identify the desired MERRA-2 data by specifying an hour code and data extents with \ref GRAM::EarthAtmosphere::setMERRA2Parameters.

~~~~~~~~~~
earth.setMERRA2Path("\path\tomy\earthdata\MERRA2data\");
earth.setMERRA2Parameters(9, -30, 60, -85, 50);
~~~~~~~~~~

NCEP Path and Parameters
------------------------

Use the function \ref GRAM::EarthAtmosphere::setNCEPPath to set the folder location of the NCEP binary data.  Identify the desired NCEP data by specifying year and hour codes with \ref GRAM::EarthAtmosphere::setNCEPParameters. By default, EarthGRAM uses the MERRA-2 model.  To activate the NCEP model, call \ref GRAM::EarthAtmosphere::setUseNCEP.

~~~~~~~~~~
earth.setUseNCEP(true);
earth.setNCEPPath("\path\tomy\earthdata\NCEPdata\FixedBin");
earth.setNCEPParameters(9715, 0);
~~~~~~~~~~

Range Reference Atmosphere (RRA) Path and Parameters
----------------------------------------------------

Use the function \ref GRAM::EarthAtmosphere::setRRAPath to set the folder location of the RRA data.  
The name of the RRA site list file can be set with \ref GRAM::EarthAtmosphere::setRRASiteList.
The function \ref GRAM::EarthAtmosphere::setRRAParameters is used to select the year of the RRA 
data set and define a region in which RRA data is used.  Use of the RRA data
is enabled or disabled with \ref GRAM::EarthAtmosphere::setUseRRA.

~~~~~~~~~~
earth.setRRAPath("\path\tomy\earthdata\RRAdata");
earth.setRRASiteList("rrasites.txt");
earth.setRRAPParameters_E(3, 0.5, 2.5);
earth.setUseRRA(true);
~~~~~~~~~~

The Thermosphere Model
----------------------

The thermosphere model is chosen with the \ref GRAM::EarthAtmosphere::setThermosphereModel method. Valid models are EG_MSIS, EG_MET, and EG_JB2008.  The default model is EG_MET.

~~~~~~~~~~
earth.setThermosphereModel(EG_JB2008);
~~~~~~~~~~

The Surface Roughness
---------------------

The surface roughness is set with \ref GRAM::EarthAtmosphere::setSurfaceRoughness. Any negative value will signify the use of 1-by-1 degree lat-lon surface data. A zero value will indicate speed-dependent surface roughness over water.  Values between 1.0e-5 and 3 override computed values with the user-specified surface roughness.

~~~~~~~~~~
earth.setSurfaceRoughness(1.34);
~~~~~~~~~~

Solar Parameters
----------------

Use the \ref GRAM::EarthAtmosphere::setSolarParameters method to set the daily F10.7, the mean F10.7, and the AP values.

~~~~~~~~~~
earth.setSolarParameters(73.1, 70.1, 16.3);
~~~~~~~~~~

JB2008 Model Parameters
-----------------------

The JB2008 thermosphere model parameters are set with the \ref GRAM::EarthAtmosphere::setJB2008Parameters method. 

~~~~~~~~~~
earth.setThermosphereModel(EG_JB2008);
earth.setJB2008Parameters(74.0, 79.5, 65.4, 75.1, 61.9, 69.6, 18.0);
~~~~~~~~~~

Initial Perturbations
---------------------

The function \ref GRAM::EarthAtmosphere::setInitialPerturbations is used to override the random initial
perturbations generated by EarthGRAM.

~~~~~~~~~~
earth.setInitialPerturbations(4.7e-9, 601.17, 91.66, -69.4, -3.4);
~~~~~~~~~~

Perturbation Scales
-------------------

Three functions are used to set the perturbation scales. \ref GRAM::EarthAtmosphere::setRandomPerturbationScale set the scale for density, temperature, and pressure perturbations.  The wind perturbation scales are set with \ref GRAM::EarthAtmosphere::setHorizontalWindPerturbationScale and \ref GRAM::EarthAtmosphere::setVerticalWindPerturbationScale.

~~~~~~~~~~
earth.setRandomPerturbationScale(1.4);
earth.setHorizontalWindPerturbationScale(1.4);
earth.setVerticalWindPerturbationScale(1.4);
~~~~~~~~~~

Patchiness in the Perturbation Model
------------------------------------

Control the severity of perturbations with \ref GRAM::EarthAtmosphere::setPatchiness.

~~~~~~~~~~
earth.setPatchiness(true);
~~~~~~~~~~

Earth Specific Metrics
----------------------

As with other models, the atmosphere state is retrieved using \ref GRAM::EarthAtmosphere::getAtmosphereState.  However, the earth model has many metrics that particular to this model.  These may be retrieved with the method  \ref GRAM::EarthAtmosphere::getEarthAtmosphereState.

~~~~~~~~~~
AtmosphereState state;
state = earth.getAtmosphereState();

EarthAtmosphereState eState;
eState = earth.getEarthAtmosphereState();
~~~~~~~~~~

Correlation Coefficients
------------------------

The method \ref GRAM::EarthAtmosphere::getCorrelationCoefficients generate correlation coefficients between two positions.  It is used by the EarthStateCorrelator.

~~~~~~~~~~
earth.getCorrelationCoefficients(basePosition, targetPosition);
~~~~~~~~~~
